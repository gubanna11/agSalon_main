@model NewAttendanceVM

@{
    ViewData["Title"] = "New Attendance";
}

<form asp-action="NewAttendance">

    <div>
        <label asp-for="GroupId"></label>
        @*<select asp-for="GroupId" asp-items="ViewBag.Groups" id="group"> </select>*@
        @Html.DropDownList("GroupId", ViewBag.Groups as SelectList, new { id = "group"})
        

        @*@Html.DropDownListFor(n => n.GroupId, (SelectList)ViewBag.Groups, new { id = "group"})*@
    </div>


    <div>
        <label asp-for="ServiceId"></label>
        @*<select asp-for="ServiceId" asp-items="ViewBag.Services" id="service"> </select>*@
        @*<select asp-for="ServiceId" id="service">*@
            @Html.DropDownList("ServiceId", ViewBag.Services as SelectList, new { id = "service" })
        @*</select>*@
        
        
    </div>

    <div>
        <label asp-for="WorkerId"></label>
        @*<select asp-for="WorkerId" asp-items="ViewBag.Workers" id="worker"> </select>*@
        @Html.DropDownList("WorkerId", ViewBag.Workers as SelectList, new { id = "worker" })
    </div>

    <div>
        <label asp-for="Date"></label>
        <input asp-for="Date" type="date" />
    </div>

    <div>
        <input type="submit" value="Create" />
    </div>
</form>

@section Scripts{
    <script type="text/javascript">
    $(function () {

        $('#group').change(function () {
            // получаем выбранный id
            var id = $(this).val();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("ServicesDropdown")/' + id,
                success: function (data) {
                    // заменяем содержимое присланным частичным представлением
                    $('#service').replaceWith(data);
                    $.ajax({
                        type: 'GET',
                        url: '@Url.Action("WorkersDropdown")/' + id,
                        success: function (data) {
                            // заменяем содержимое присланным частичным представлением
                            $('#worker').replaceWith(data)
                }
            });
                }
            });

        });
    })
    </script>
}